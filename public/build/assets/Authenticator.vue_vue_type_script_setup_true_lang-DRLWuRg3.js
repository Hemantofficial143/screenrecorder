import{e as b}from"./mixin-Dc86sEW9.js";import{h as w,o as _,c as V,w as o,q as m,s as k,x as A,u as l,y as C,k as E,T as x,Q as F,r as q,z as B,f as P,a,b as n,d as u,F as T,A as $,E as N,l as S,p as D,m as M}from"./app-BmcLlJwC.js";const R={__name:"ElModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:""}},setup(p){let e=p;return w(()=>e.show),(r,f)=>{const c=C;return _(),V(c,k(A(l(e))),{footer:o(()=>[m(r.$slots,"footer")]),default:o(()=>[m(r.$slots,"default")]),_:3},16)}}},z=["innerHTML"],H={class:"dialog-footer"},I=n("header",null,[n("h2",{class:"text-lg font-medium text-gray-900"},"2-Step Verification")],-1),L={class:"mt-6 space-y-6"},G=E({__name:"Authenticator",setup(p){const e=x({enable:!1,qr_code:"",otp:""});F().props.auth.user;const r=q(null),f=s=>{s&&s.validate(t=>{t?e.post(route("profile.set2fa"),{}):b("Please solve errors first!.")})},c=async()=>{let s=await $.post(route("profile.get2fa"));s.data.success&&(e.enable=!0,e.qr_code=s.data.qr_code,e.otp="")};return(s,t)=>{const h=N,g=S,y=D,v=B("center"),d=M;return _(),P(T,null,[a(R,{modelValue:l(e).enable,"onUpdate:modelValue":t[3]||(t[3]=i=>l(e).enable=i),title:"Add 2-step verification Device","close-on-press-escape":!1,"close-on-click-modal":!1},{footer:o(()=>[n("div",H,[a(d,{onClick:t[1]||(t[1]=i=>l(e).enable=!1)},{default:o(()=>[u("Cancel")]),_:1}),a(d,{type:"primary",onClick:t[2]||(t[2]=i=>f(r.value))},{default:o(()=>[u(" Confirm ")]),_:1})])]),default:o(()=>[a(v,null,{default:o(()=>[a(y,{ref_key:"authenticatorFormRef",ref:r,model:l(e)},{default:o(()=>[u(" Set up your two factor authentication by scanning the barcode below with you Google Authenticator App "),n("div",{innerHTML:l(e).qr_code},null,8,z),n("div",null,[a(g,{prop:"otp",rules:[{required:!0,message:"Please Enter OTP from Authenticator",trigger:["blur","input"]}]},{default:o(()=>[a(h,{modelValue:l(e).otp,"onUpdate:modelValue":t[0]||(t[0]=i=>l(e).otp=i),style:{width:"30%"},placeholder:"OTP"},null,8,["modelValue"])]),_:1})])]),_:1},8,["model"])]),_:1})]),_:1},8,["modelValue"]),n("section",null,[I,n("form",L,[a(d,{type:"primary",onClick:c},{default:o(()=>[u("Add New Device")]),_:1})])])],64)}}});export{G as _};
