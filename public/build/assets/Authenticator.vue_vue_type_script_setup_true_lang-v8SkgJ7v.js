import{e as b}from"./mixin-BLLk0eEI.js";import{h as w,o as _,c as V,w as o,q as m,s as k,x as A,u as l,y as C,k as E,T as x,Q as F,r as q,z as B,f as P,a,b as n,d as u,t as T,F as D,A as S,E as $,l as N,p as M,m as R}from"./app-D-1IVh4X.js";const z={__name:"ElModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:""}},setup(c){let e=c;return w(()=>e.show),(r,f)=>{const d=C;return _(),V(d,k(A(l(e))),{footer:o(()=>[m(r.$slots,"footer")]),default:o(()=>[m(r.$slots,"default")]),_:3},16)}}},H=["innerHTML"],I={class:"dialog-footer"},L=n("h2",{class:"text-lg font-medium text-gray-900"},"2-Step Verification",-1),O={class:"mt-6 space-y-6"},Q=E({__name:"Authenticator",props:{authenticator_device_count:{default:0}},setup(c){const e=x({enable:!1,qr_code:"",otp:""});F().props.auth.user;const r=q(null),f=s=>{s&&s.validate(t=>{t?e.post(route("profile.set2fa"),{}):b("Please solve errors first!.")})},d=async()=>{let s=await S.post(route("profile.get2fa"));s.data.success&&(e.enable=!0,e.qr_code=s.data.qr_code,e.otp="")};return(s,t)=>{const h=$,g=N,v=M,y=B("center"),p=R;return _(),P(D,null,[a(z,{modelValue:l(e).enable,"onUpdate:modelValue":t[3]||(t[3]=i=>l(e).enable=i),title:"Add 2-step verification Device","close-on-press-escape":!1,"close-on-click-modal":!1},{footer:o(()=>[n("div",I,[a(p,{onClick:t[1]||(t[1]=i=>l(e).enable=!1)},{default:o(()=>[u("Cancel")]),_:1}),a(p,{type:"primary",onClick:t[2]||(t[2]=i=>f(r.value))},{default:o(()=>[u(" Confirm ")]),_:1})])]),default:o(()=>[a(y,null,{default:o(()=>[a(v,{ref_key:"authenticatorFormRef",ref:r,model:l(e)},{default:o(()=>[u(" Set up your two factor authentication by scanning the barcode below with you Google Authenticator App "),n("div",{innerHTML:l(e).qr_code},null,8,H),n("div",null,[a(g,{prop:"otp",rules:[{required:!0,message:"Please Enter OTP from Authenticator",trigger:["blur","input"]}]},{default:o(()=>[a(h,{modelValue:l(e).otp,"onUpdate:modelValue":t[0]||(t[0]=i=>l(e).otp=i),style:{width:"30%"},placeholder:"OTP"},null,8,["modelValue"])]),_:1})])]),_:1},8,["model"])]),_:1})]),_:1},8,["modelValue"]),n("section",null,[n("header",null,[L,n("small",null,T(c.authenticator_device_count)+" Device(s) Enrolled",1)]),n("form",O,[a(p,{type:"primary",onClick:d},{default:o(()=>[u("Add New Device")]),_:1})])])],64)}}});export{Q as _};
